<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>ME-X Executive | Master Control</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@1,400&family=Montserrat:wght@300;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; background: #fcfcfc; }
        .serif { font-family: 'Cormorant Garamond', serif; }
        .hidden { display: none !important; }
        .sidebar-link { @apply pl-4 py-2 text-[10px] uppercase font-bold tracking-widest text-gray-400 border-l-2 border-transparent transition-all cursor-pointer; }
        .sidebar-link.active { @apply text-black border-black; }
    </style>
</head>
<body class="flex min-h-screen">

    <aside class="w-64 bg-white border-r p-8 flex flex-col gap-12 sticky top-0 h-screen">
        <div class="serif text-2xl italic tracking-widest">ME-X Master</div>
        <nav class="flex flex-col gap-6">
            <div onclick="showSection('overview')" id="nav-overview" class="sidebar-link active">Overview</div>
            <div onclick="showSection('calendar')" id="nav-calendar" class="sidebar-link">Master Calendar</div>
            <div onclick="showSection('catalog')" id="nav-catalog" class="sidebar-link text-amber-600">Product Catalog</div>
        </nav>
    </aside>

    <main class="flex-1 p-12 overflow-y-auto italic">
        
        <section id="overview" class="content-section">
            <h2 class="text-4xl serif italic mb-10">Stato Globale</h2>
            <div class="grid grid-cols-3 gap-8">
                <div class="bg-white p-10 rounded-[2.5rem] border shadow-sm">
                    <p class="text-[9px] font-bold text-gray-400 uppercase tracking-widest mb-2">Revenue</p>
                    <h3 class="text-3xl serif italic">€ 14.500</h3>
                </div>
            </div>
        </section>

        <section id="calendar" class="content-section hidden">
            <h2 class="text-4xl serif italic mb-10">Master Calendar Sync</h2>
            <div class="bg-white p-10 rounded-[2.5rem] border grid grid-cols-7 gap-1" id="calendar-grid">
                </div>
        </section>

        <section id="catalog" class="content-section hidden">
            <h2 class="text-4xl serif italic mb-10">Add Activities & Services</h2>
            <div class="bg-white p-10 rounded-[2.5rem] border max-w-2xl">
                <div class="space-y-6">
                    <input type="text" id="p-name" placeholder="NOME PRODOTTO" class="w-full border-b py-3 outline-none text-[10px] uppercase">
                    <input type="number" id="p-price" placeholder="PREZZO (€)" class="w-full border-b py-3 outline-none text-[10px] uppercase">
                    <select id="p-type" class="w-full border-b py-3 outline-none text-[10px] uppercase">
                        <option value="attivita">ATTIVITÀ</option>
                        <option value="servizio">SERVIZIO</option>
                    </select>
                    <textarea id="p-desc" placeholder="DESCRIZIONE" class="w-full border-b py-3 outline-none text-[10px] uppercase"></textarea>
                    <button onclick="saveProduct()" class="w-full bg-black text-white py-4 text-[10px] font-bold tracking-widest uppercase rounded-full">Pubblica Prodotto</button>
                </div>
            </div>
        </section>
    </main>

    <script>
        function showSection(id) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
            document.getElementById('nav-' + id).classList.add('active');
            if(id === 'calendar') renderCalendar();
        }

        function renderCalendar() {
            const grid = document.getElementById('calendar-grid');
            grid.innerHTML = '';
            for(let i=1; i<=31; i++) {
                grid.innerHTML += `<div class="h-24 border p-2 text-[10px] text-gray-300"><strong>${i}</strong></div>`;
            }
        }

        async function saveProduct() {
            const data = {
                name: document.getElementById('p-name').value,
                price: document.getElementById('p-price').value,
                type: document.getElementById('p-type').value,
                desc: document.getElementById('p-desc').value
            };
            const res = await fetch('/api/admin/add-provider', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            });
            if(res.ok) { alert("Catalogo aggiornato."); location.reload(); }
        }
    </script>
</body>
</html>
